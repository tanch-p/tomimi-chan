import{_ as yt}from"./stage_name_lookup_table.8349fe42.js";import{S as lt,i as st,s as nt,e as L,b as k,F,h,P as Y,k as T,q as M,a as z,l as G,m as D,r as V,c as A,n as p,E as y,u as W,G as Q,N as J,y as ee,z as te,A as le,g as R,d as U,B as se,o as wt,a7 as Et,_ as It,v as Z,f as $,$ as Pt,H as Tt,I as Gt,J as jt,K as St,w as rt,a0 as ot,a1 as it}from"./index.51467544.js";import{t as K}from"./translations.d941d3dd.js";import{T as Dt}from"./TogglePanel.47499b18.js";import{a as Nt,b as Kt,f as Ot}from"./rogue_4_fragment_F_28.5fb1037a.js";import{c as zt,d as At}from"./disasters.065bc269.js";import{g as Mt,h as me,i as Vt}from"./StageHeadMeta.61b9b52d.js";import{G as ct}from"./DraggableContainer.1874c90f.js";import{D as qt,G as re}from"./lib.110a2bb4.js";const Bt=["enemy_2073_skzrck","enemy_2094_skzamb","enemy_2094_skzamb_2","enemy_1106_byokai_b","enemy_3005_lpeopl","enemy_2101_dyspll","enemy_10060_cjbfod","enemy_2119_dyshhj_2"],at=["enemy_2086_skzdwx"],ne=["SPAWN","ACTIVATE_PREDEFINED","EMPTY"],he=["trap_051_vultres","trap_068_badbox","trap_110_smbbox","trap_758_skzmbx","trap_225_dysbox"],Lt=["enemy_2035_sybox","enemy_2059_smbox","enemy_2069_skzbox","enemy_2106_dyremy"],oe=(t,e)=>{const l=Ot.find(s=>s.id===t);return l[`name_${e}`]||l.name_zh};function zl(t){for(let e=t.length-1;e>0;e--){const l=Math.floor(Math.random()*(e+1));[t[e],t[l]]=[t[l],t[e]]}return t}const Wt=(t,e,l,s)=>{const n=[],c=[];for(const i of t.waves)for(const o of i.fragments)for(const a of o.actions)a.actionType==="ACTIVATE_PREDEFINED"&&c.push(a.key.split("#")[0]);const r=[...new Set(c)];switch(e){case"rogue_phantom":r.includes("trap_051_vultres")&&n.push({key:"trap_051_vultres",src:"/images/chara_icons/trap_051_vultres.webp",name:K[s].treasure}),t.elite_mods&&n.push({key:"extra",src:"",name:"紧急作战 + 怒想症 / 猩红《赫里亚之辉》"}),["level_rogue1_b-6","level_rogue1_b-7","level_rogue1_b-8","level_rogue1_b-9"].includes(t.levelId)&&n.push({key:"reforge",src:"",name:"N12以上结局关卡"});break;case"rogue_mizuki":for(const i of r){if(i==="trap_068_badbox"){n.push({key:"trap_068_badbox",src:"/images/chara_icons/trap_068_badbox.webp",name:K[s].treasure});continue}if(i==="trap_079_allydonq"){n.push({key:"allydonq",src:"/images/enemy_icons/enemy_2038_sydonq.webp",name:{zh:"猎潮的骑士",ja:"猟潮の騎士",en:"Tide-Hunt Knight"}[s]});continue}}break;case"rogue_sami":for(const i of r)if(i==="trap_110_smbbox"){n.push({key:"trap_110_smbbox",src:"/images/chara_icons/trap_110_smbbox.webp",name:K[s].treasure});continue}n.push({key:"totem2",src:"/images/chara_icons/trap_024_npcsld.webp",name:{zh:"盾卫",ja:"盾兵",en:"Shieldguard"}[s]},{key:"totem1",src:"/images/enemy_icons/enemy_1106_byokai.webp",name:{zh:"斗志昂扬无人机",ja:"闘志高揚ドローン",en:"Cheering Sponsor Drone"}[s]},{key:"bossrelic",src:"/images/relics/relic_routeweave_net.webp",name:{zh:"路网",ja:"導きの網織",en:"Routeweave Net"}[s]});break;case"rogue_skz":for(const i of r){if(i==="trap_758_skzmbx"){n.push({key:"trap_758_skzmbx",src:"/images/chara_icons/trap_758_skzmbx.webp",name:K[s].treasure});continue}if(i==="trap_764_skzshp"){n.push({key:"trap_764_skzshp",src:"/images/chara_icons/trap_764_skzshp.webp",name:{zh:"驮兽旅行家",ja:"旅する駄獣",en:"Burdenbeast Traveler"}[s]});continue}}n.push({key:"calamity",src:zt,name:{zh:"天灾年代",ja:"天災の時代",en:"Catastrophes"}[s]},{key:"hidden_door",src:"/images/enemy_icons/enemy_2067_skzcy.webp",name:oe("rogue_4_fragment_F_08",s)},{key:"hidden_window",src:"/images/enemy_icons/enemy_2091_skzgds.webp",name:oe("rogue_4_fragment_F_29",s)},{key:"box_1",src:Nt,name:oe("rogue_4_fragment_F_27",s)},{key:"box_3",src:Kt,name:oe("rogue_4_fragment_F_28",s)},{key:"shadow",src:"/images/enemy_icons/enemy_2093_skzams.webp",name:{zh:"终曲合声",ja:"终曲合声",en:"终曲合声"}[s]});break;case"rogue_yan":for(const i of r)if(i==="trap_225_dysbox"){n.push({key:"trap_225_dysbox",src:"/images/chara_icons/trap_225_dysbox.webp",name:K[s].treasure});continue}n.push({key:"copper_b",src:"/images/relics/rogue_5_relic_final_3.webp",name:{zh:"隐蝶墨",ja:"隐蝶墨",en:"隐蝶墨"}[s]},{key:"copper_r",src:"/images/relics/rogue_5_copper_S_1.webp",name:{zh:"花-鸭爵金币",ja:"花-鸭爵金币",en:"花-鸭爵金币"}[s]});break}return n},Ft=(t,e,l,s,n)=>{const c=["hidden_door","hidden_window","box_1","box_3"];if(l==="rogue_skz"&&e==="calamity"){const r=s<5?1:s<11?2:3,i=At.find(o=>o.iconId==="rogue_4_disaster_1"&&o.level===r);n.disaster.update(o=>(o.find(a=>a.id===i.id)?o=[]:o=[i],o))}if(l==="rogue_yan"&&e==="copper_r"){const r=Mt.find(i=>i.id==="rogue_5_copper_S_1");n.relics.update(i=>(i.find(o=>o.id===r.id)?i=i.filter(o=>o.id!==r.id):i=[...i,r],i))}switch(l==="rogue_phantom"&&e==="extra"&&(t.includes(e)||n.eliteMode.set(!0)),l){case"rogue_skz":if(t.includes(e))t=t.filter(r=>r!==e);else if(c.includes(e)){t=t.filter(r=>!c.includes(r)),t.push(e);break}else t.push(e);break;default:t.includes(e)?t=t.filter(r=>r!==e):t.push(e);break}return t},ie=(t,e)=>{if(!e)return!1;for(const l of t)if(l.randomSpawnGroupPackKey===e&&l.randomSpawnGroupKey)return!0;return!1},Rt=(t,e)=>{let l=0;return t.waves.forEach((s,n)=>{s.fragments.forEach((c,r)=>{for(const i of c.actions)i.actionType==="SPAWN"&&(i.randomSpawnGroupKey||ie(c.actions,i.randomSpawnGroupPackKey)||i.hiddenGroup||["level_rogue4_b-4","level_rogue4_b-4-b","level_rogue4_b-5","level_rogue4_b-5-b"].includes(t.levelId)&&i.key==="enemy_2090_skzjbc"&&!e||x(i.key,t)&&(l+=i.count))})}),l},Ut=(t,e)=>{var c,r;let l=t;const s=e.enemies.find(i=>i.id===t||i.prefabKey===t);if(s&&(l=s.prefabKey),!me[l])return!0;let n=!me[l].notCountInTotal;return(c=s==null?void 0:s.overwrittenData)!=null&&c.notCountInTotal&&(n=!((r=s==null?void 0:s.overwrittenData)!=null&&r.notCountInTotal)),n},x=(t,e)=>["trap","char","token"].some(l=>t.includes(l))||t===""||Bt.includes(t)||at.includes(t)?!1:Ut(t,e),Ct=(t,e,l,s,n)=>{const r=t[l?"ELITE":"NORMAL"].permutations,i=t.bonus,o=t.waves.reduce((f,u,_)=>((i==null?void 0:i.type)==="wave"&&_===i.wave_index||u.fragments.forEach((b,m)=>{(i==null?void 0:i.type)==="fragment"&&_===i.wave_index&&m===i.frag_index||b.actions.forEach(d=>{ne.includes(d.actionType)||e.includes(d.hiddenGroup)&&!d.randomSpawnGroupKey&&!d.randomSpawnGroupPackKey&&x(d.key,t)&&(f+=d.count)})}),f),0);return r.map(f=>{let u=0;return t.waves.forEach((_,b)=>{(i==null?void 0:i.type)==="wave"&&b===i.wave_index||_.fragments.forEach((m,d)=>{var S;const w=ce(m,e),v=`w${b}f${d}`;let P=[];for(const[B,q]of Object.entries(w)){const g=(S=f==null?void 0:f[v])==null?void 0:S[B];g&&(q!=null&&q[g])?P=P.concat(q[g]):P=P.concat(q[0])}for(const B of P.filter(Boolean))x(B.key,t)&&(u+=B.count)})}),{count:n+o+u+(i&&s?1:0),permutation:f}}).sort((f,u)=>f.count-u.count)};function Ht(t,e){for(const l in e)for(const s of e[l])if(t.randomSpawnGroupPackKey===s.randomSpawnGroupPackKey){e[l].push(t);return}}function Yt(t){const e={},l=[];for(const s of t){const n=s.randomSpawnGroupKey;n!=null?(e[n]||(e[n]=[]),e[n].push(s)):l.push(s)}for(const s of l){const n=s.randomSpawnGroupPackKey;n!=null&&Ht(s,e)}return e}function Jt(t){const e={};for(const l in t){const s={};for(const n of t[l]){const c=n.randomSpawnGroupPackKey;s[c]||(s[c]=[]),s[c].push(n)}if(Object.keys(s).length===1)for(const n in s)e[l]=s[n];else{const n=[];for(const c in s)n.push(s[c]);e[l]=n}}return e}const de=(t,e,l,s,n,c)=>{var u;if(!l)return;let r=0;const i=s?((u=t.elite_runes)==null?void 0:u.enemy_replace)||{}:{};let o=0;const a=[],{waves:f}=t;return f.forEach((_,b)=>{let m=0,d={},w={};_.fragments.forEach((P,S)=>{var O;m+=P.preDelay;const B=ce(P,e),q=`w${b}f${S}`;let g=[];for(const[N,E]of Object.entries(B)){if(E.length===1){g.push(E[0]);continue}let j=(O=l==null?void 0:l[q])==null?void 0:O[N];if(j==null){const C=t.bonus?q===`w${t.bonus.wave_index}f${Math.max(0,t.bonus.frag_index)}`:!1;j=ft(E,e,c,C?t.bonus:null),j==null&&(j=Math.floor(n[r]*E.length),r+=1)}E!=null&&E[j]&&(g=g.concat(E[j]))}for(const N of g)fe(N,d,w,m,i),x(N.key,t)&&(o+=N.count);for(const N of P.actions)ne.includes(N.actionType)&&(N.randomSpawnGroupKey||ie(P.actions,N.randomSpawnGroupPackKey)||N.hiddenGroup&&!e.includes(N.hiddenGroup)||["level_rogue4_b-4","level_rogue4_b-4-b","level_rogue4_b-5","level_rogue4_b-5-b"].includes(t.levelId)&&N.key==="enemy_2090_skzjbc"&&!s||at.includes(N.key)||(fe(N,d,w,m,i),x(N.key,t)&&(o+=N.count)));Object.keys(w).length>0&&(m=Math.max(...Object.keys(w).map(Number)))});const v=Object.keys(d).map(Number);if(!(["level_rogue4_b-7","level_rogue4_b-8"].includes(t.levelId)&&v.length===0)){v.sort((S,B)=>S-B);const P=v.map(S=>({t:S,actions:d[S]}));a.push({preDelay:_.preDelay,postDelay:_.postDelay,maxTimeWaitingForNextWave:_.maxTimeWaitingForNextWave,timeline:P})}}),{waves:a,count:o}},Al=(t,e,l=-1,s=0)=>{var i,o,a,f,u;if(!e||!((i=t==null?void 0:t.branches)!=null&&i[e]))return;const n=[];let c=(a=(o=t==null?void 0:t.branches)==null?void 0:o[e])==null?void 0:a.phases;return l!==-1&&(c=[(u=(f=t==null?void 0:t.branches)==null?void 0:f[e])==null?void 0:u.phases[l]]),[{fragments:c}].forEach(_=>{let b=0;const m={};_.fragments.forEach(w=>{b+=w.preDelay+s;for(const v of w.actions)ne.includes(v.actionType)&&fe(v,m,{},b)});const d=Object.keys(m).map(Number);if(d.length!==0){d.sort((v,P)=>v-P);const w=d.map(v=>({t:v,actions:m[v]}));n.push({preDelay:0,postDelay:0,maxTimeWaitingForNextWave:-1,timeline:w})}}),n},fe=(t,e,l,s,n={})=>{var r;if(t.key==="")return;let c=t.key;if(n[t.key]&&(c=n[t.key]),["trap","char","token"].some(i=>c.includes(i))&&(c=(r=c.split("#"))==null?void 0:r[0]),t.count>1)for(let i=0;i<t.count;i++){const o=s+t.preDelay+i*t.interval;e!=null&&e[o]||(e[o]=[]),e[o].push({key:c}),l[o]||(l[o]=[],l[o].push({key:t.key}))}else{const i=s+t.preDelay;e!=null&&e[i]||(e[i]=[]),e[i].push({key:c}),l[i]||(l[i]=[],l[i].push({key:t.key}))}},pe=(t,e,l,s,n,c)=>{let r=0;const i=structuredClone(t.waves);return i.forEach((o,a)=>{const f=[];o.fragments.forEach((u,_)=>{var P;const b=structuredClone(u),m=`w${a}f${_}`,d=[];let w=[];const v=ce(u,l);for(const[S,B]of Object.entries(v)){if(B.length===1){w.push(B[0]);continue}let q=(P=e==null?void 0:e[m])==null?void 0:P[S];if(q==null){const g=t.bonus?m===`w${t.bonus.wave_index}f${Math.max(0,t.bonus.frag_index)}`:!1;q=ft(B,l,c,g?t.bonus:null),q==null&&(q=Math.floor(n[r]*B.length),r+=1)}B!=null&&B[q]&&(w=w.concat(B[q]))}for(const S of w)d.push(S);for(const S of u.actions)ne.includes(S.actionType)&&(["level_rogue4_b-4","level_rogue4_b-4-b","level_rogue4_b-5","level_rogue4_b-5-b"].includes(t.levelId)&&S.key==="enemy_2090_skzjbc"&&!s||S.randomSpawnGroupKey||ie(u.actions,S.randomSpawnGroupPackKey)||S.hiddenGroup&&!l.includes(S.hiddenGroup)||d.push(S));b.actions=d,f.push(b)}),o.fragments=f}),i},ft=(t,e,l,s)=>{if(!Array.isArray(t==null?void 0:t[0])){const n=t.findIndex(c=>he.includes(c.key.split("#")[0]));if(n!==-1&&e.some(c=>he.includes(c)))return n;if(s)return l?t.findIndex(r=>r.key===l):-1}},ce=(t,e)=>{const l=[];for(const r of t.actions){const{actionType:i,randomSpawnGroupKey:o,randomSpawnGroupPackKey:a}=r;if(ne.includes(i)&&!["trap_036_storm"].includes(r.key.split("#")[0])){if(o){l.push(r);continue}ie(t.actions,a)&&l.push(r)}}const s=Yt(l),n=Jt(s);for(const r of Object.keys(n)){let i=!1;for(let o=0;o<n[r].length;o++)Array.isArray(n[r][o])&&(i=!0,n[r][o]=n[r][o].filter(a=>!a.hiddenGroup||e.includes(a.hiddenGroup)));i||(n[r]=n[r].filter(o=>!o.hiddenGroup||e.includes(o.hiddenGroup)))}return Object.keys(n).reduce((r,i)=>(n[i].some(o=>Array.isArray(o)?o.length>0:!!o)&&(r[i]=n[i]),r),{})},Qt=(t,e,l,s,n)=>{const c=e?l.ELITE.groupKey:l.NORMAL.groupKey;let r=structuredClone(t);return c&&(r=[...r,c]),s==="rogue_yan"&&!(n!=null&&n.some(i=>i.id==="rogue_5_copper_S_1"))&&(r=[...r,"copper_d"]),r},Xt=(t,e,l)=>{const s=e?t.ELITE.groupKey:t.NORMAL.groupKey,n=structuredClone(l);s&&n.push(s);const c={};return t.waves.forEach((r,i)=>{r.fragments.forEach((o,a)=>{const f=`w${i}f${a}`,u={};for(const _ of o.actions){const{hiddenGroup:b,randomSpawnGroupKey:m}=_;b&&!n.includes(b)||m&&!u[m]&&(u[m]=0)}if(Object.keys(u).length>0){c[f]={};for(const[_,b]of Object.entries(u))c[f][_]=b}})}),structuredClone(c)},ut=(t,e)=>{var s;if(Array.isArray(t)){const c=(s=t.find(i=>i.randomSpawnGroupKey))==null?void 0:s.weight,r=e.reduce((i,o)=>{var f;const a=(f=o.find(u=>u.randomSpawnGroupKey))==null?void 0:f.weight;return i+=a,i},0);return Math.round(c/r*100)}const l=e.reduce((n,c)=>(n+=c.weight,n),0);return Math.round(t/l*1e3)/10},Zt=t=>{const e=[];for(const l of t){const s=e.find(n=>n.key===l.key);s?s.count+=l.count||1:e.push({key:l.key,count:l.count||1})}return e},be=t=>{switch(t){case"rogue_phantom":return["","enemy_2001_duckmi","enemy_2002_bearmi"];case"rogue_sami":return["","enemy_2001_duckmi","enemy_2002_bearmi","enemy_2034_sythef"];default:return["","enemy_2001_duckmi","enemy_2002_bearmi","enemy_2034_sythef","enemy_2085_skzjxd"]}},_t=(t,e)=>{var l,s,n;return t.includes("skzamj")||t.includes("skzamf")?(s=(l=e.enemies.find(i=>i.id===t).overwrittenData.talentBlackboard.find(i=>i.key==="transform"))==null?void 0:l.value)==null?void 0:s.replace("skzams_1","skzams").replace("upeopl_1","upeopl"):(n=e.enemies.find(c=>c.id===t))==null?void 0:n.prefabKey};function Ml(t,e){var s;const l=(s=t==null?void 0:t[e])==null?void 0:s.phases;if(!(!l||l.length>1))for(const n of l){if(n.actions.length>1)return;for(const c of n.actions)if(Lt.some(r=>c.key.includes(r)))return!0}}function ge(t,e,l){const s=t.slice();s[9]=e[l],s[12]=l;const n=s[9].fragments.map(c=>ce(c,s[2]));return s[10]=n,s}function ve(t,e,l){const s=t.slice();return s[13]=e[l],s[15]=l,s}function ke(t,e,l){const s=t.slice();return s[16]=e[l][0],s[17]=e[l][1],s}function ye(t,e,l){const s=t.slice();s[20]=e[l],s[23]=l;const n=`w${s[12]}f${s[15]}`;return s[21]=n,s}function $t(t){var s;const e=t.slice(),l=e[26].key.includes("trap")?(s=e[26].key.split("#"))==null?void 0:s[0]:_t(e[26].key,e[1]);return e[29]=l,e}function we(t,e,l){const s=t.slice();return s[26]=e[l],s}function xt(t){var s;const e=t.slice(),l=e[26].key.includes("trap")?(s=e[26].key.split("#"))==null?void 0:s[0]:_t(e[26].key,e[1]);return e[29]=l,e}function el(t){const e=t.slice(),l=e[20];e[26]=l;const s=ut(e[26].weight,e[17]);return e[24]=s,e}function tl(t){const e=t.slice(),l=ut(e[20],e[17]);e[24]=l;const s=Zt(e[20]);return e[25]=s,e}function Ee(t){let e,l=t[1].waves,s=[];for(let n=0;n<l.length;n+=1)s[n]=Ae(ge(t,l,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=L()},l(n){for(let c=0;c<s.length;c+=1)s[c].l(n);e=L()},m(n,c){for(let r=0;r<s.length;r+=1)s[r]&&s[r].m(n,c);k(n,e,c)},p(n,c){if(c&31){l=n[1].waves;let r;for(r=0;r<l.length;r+=1){const i=ge(n,l,r);s[r]?s[r].p(i,c):(s[r]=Ae(i),s[r].c(),s[r].m(e.parentNode,e))}for(;r<s.length;r+=1)s[r].d(1);s.length=l.length}},d(n){Y(s,n),n&&h(e)}}}function Ie(t){let e,l=K[t[3]].enemy_wave+"",s,n,c=t[12]+1+"",r,i,o,a,f=t[9].fragments,u=[];for(let _=0;_<f.length;_+=1)u[_]=ze(ve(t,f,_));return{c(){e=T("p"),s=M(l),n=M(" #"),r=M(c),i=z(),o=T("div");for(let _=0;_<u.length;_+=1)u[_].c();a=z(),this.h()},l(_){e=G(_,"P",{class:!0});var b=D(e);s=V(b,l),n=V(b," #"),r=V(b,c),b.forEach(h),i=A(_),o=G(_,"DIV",{class:!0});var m=D(o);for(let d=0;d<u.length;d+=1)u[d].l(m);a=A(m),m.forEach(h),this.h()},h(){p(e,"class","title svelte-3b9ka6"),p(o,"class","pb-2")},m(_,b){k(_,e,b),y(e,s),y(e,n),y(e,r),k(_,i,b),k(_,o,b);for(let m=0;m<u.length;m+=1)u[m]&&u[m].m(o,null);y(o,a)},p(_,b){if(b&8&&l!==(l=K[_[3]].enemy_wave+"")&&W(s,l),b&23){f=_[9].fragments;let m;for(m=0;m<f.length;m+=1){const d=ve(_,f,m);u[m]?u[m].p(d,b):(u[m]=ze(d),u[m].c(),u[m].m(o,a))}for(;m<u.length;m+=1)u[m].d(1);u.length=f.length}},d(_){_&&h(e),_&&h(i),_&&h(o),Y(u,_)}}}function Pe(t){let e,l,s,n,c,r=Object.entries(t[10][t[15]]),i=[];for(let o=0;o<r.length;o+=1)i[o]=Oe(ke(t,r,o));return{c(){e=T("div"),l=T("span"),s=M("f"),n=M(t[15]),c=z();for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=G(o,"DIV",{class:!0});var a=D(e);l=G(a,"SPAN",{class:!0});var f=D(l);s=V(f,"f"),n=V(f,t[15]),f.forEach(h),c=A(a);for(let u=0;u<i.length;u+=1)i[u].l(a);a.forEach(h),this.h()},h(){p(l,"class","text-xs ml-1.5 opacity-80"),p(e,"class","relative border-b border-neutral-700 last:border-none")},m(o,a){k(o,e,a),y(e,l),y(l,s),y(l,n),y(e,c);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null)},p(o,a){if(a&23){r=Object.entries(o[10][o[15]]);let f;for(f=0;f<r.length;f+=1){const u=ke(o,r,f);i[f]?i[f].p(u,a):(i[f]=Oe(u),i[f].c(),i[f].m(e,null))}for(;f<i.length;f+=1)i[f].d(1);i.length=r.length}},d(o){o&&h(e),Y(i,o)}}}function ll(t){let e,l,s,n,c=t[24]+"",r,i,o,a,f;function u(w,v){return w[26].key===""?sl:Ge}function _(w,v){return v===Ge?$t(w):w}let b=u(t),m=b(_(t,b));function d(){return t[8](t[21],t[16],t[23])}return{c(){e=T("button"),l=T("div"),m.c(),s=z(),n=T("p"),r=M(c),i=M("%"),this.h()},l(w){e=G(w,"BUTTON",{class:!0});var v=D(e);l=G(v,"DIV",{class:!0});var P=D(l);m.l(P),P.forEach(h),s=A(v),n=G(v,"P",{class:!0});var S=D(n);r=V(S,c),i=V(S,"%"),S.forEach(h),v.forEach(h),this.h()},h(){var w,v;p(l,"class","flex items-center justify-center"),p(n,"class","text-center"),p(e,"class",o=((v=(w=t[0])==null?void 0:w[t[21]])==null?void 0:v[t[16]])===t[23]?"":"brightness-50 hover:brightness-90")},m(w,v){k(w,e,v),y(e,l),m.m(l,null),y(e,s),y(e,n),y(n,r),y(n,i),a||(f=Q(e,"click",d),a=!0)},p(w,v){var P,S;t=w,b===(b=u(t))&&m?m.p(_(t,b),v):(m.d(1),m=b(_(t,b)),m&&(m.c(),m.m(l,null))),v&6&&c!==(c=t[24]+"")&&W(r,c),v&7&&o!==(o=((S=(P=t[0])==null?void 0:P[t[21]])==null?void 0:S[t[16]])===t[23]?"":"brightness-50 hover:brightness-90")&&p(e,"class",o)},d(w){w&&h(e),m.d(),a=!1,f()}}}function Te(t){let e,l,s,n,c=t[24]+"",r,i,o,a,f,u=t[25],_=[];for(let m=0;m<u.length;m+=1)_[m]=Ne(we(t,u,m));function b(){return t[7](t[21],t[16],t[23])}return{c(){e=T("button"),l=T("div");for(let m=0;m<_.length;m+=1)_[m].c();s=z(),n=T("p"),r=M(c),i=M("%"),this.h()},l(m){e=G(m,"BUTTON",{class:!0});var d=D(e);l=G(d,"DIV",{class:!0});var w=D(l);for(let P=0;P<_.length;P+=1)_[P].l(w);w.forEach(h),s=A(d),n=G(d,"P",{class:!0});var v=D(n);r=V(v,c),i=V(v,"%"),v.forEach(h),d.forEach(h),this.h()},h(){var m,d;p(l,"class","flex items-center justify-center gap-x-1.5 border"),p(n,"class","text-center"),p(e,"class",o=((d=(m=t[0])==null?void 0:m[t[21]])==null?void 0:d[t[16]])===t[23]?"":"brightness-50 hover:brightness-90")},m(m,d){k(m,e,d),y(e,l);for(let w=0;w<_.length;w+=1)_[w]&&_[w].m(l,null);y(e,s),y(e,n),y(n,r),y(n,i),a||(f=Q(e,"click",b),a=!0)},p(m,d){var w,v;if(t=m,d&6){u=t[25];let P;for(P=0;P<u.length;P+=1){const S=we(t,u,P);_[P]?_[P].p(S,d):(_[P]=Ne(S),_[P].c(),_[P].m(l,null))}for(;P<_.length;P+=1)_[P].d(1);_.length=u.length}d&6&&c!==(c=t[24]+"")&&W(r,c),d&7&&o!==(o=((v=(w=t[0])==null?void 0:w[t[21]])==null?void 0:v[t[16]])===t[23]?"":"brightness-50 hover:brightness-90")&&p(e,"class",o)},d(m){m&&h(e),Y(_,m),a=!1,f()}}}function Ge(t){let e,l,s,n,c,r=t[26].count>1&&je(t);return{c(){e=T("div"),l=T("img"),c=z(),r&&r.c(),this.h()},l(i){e=G(i,"DIV",{class:!0});var o=D(e);l=G(o,"IMG",{src:!0,width:!0,height:!0,alt:!0}),c=A(o),r&&r.l(o),o.forEach(h),this.h()},h(){J(l.src,s=t[26].key.includes("trap")?`/images/chara_icons/${t[29]}.webp`:`/images/enemy_icons/${t[29]}.webp`)||p(l,"src",s),p(l,"width","50"),p(l,"height","50"),p(l,"alt",n=t[26].key),p(e,"class","relative")},m(i,o){k(i,e,o),y(e,l),y(e,c),r&&r.m(e,null)},p(i,o){o&6&&!J(l.src,s=i[26].key.includes("trap")?`/images/chara_icons/${i[29]}.webp`:`/images/enemy_icons/${i[29]}.webp`)&&p(l,"src",s),o&6&&n!==(n=i[26].key)&&p(l,"alt",n),i[26].count>1?r?r.p(i,o):(r=je(i),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(i){i&&h(e),r&&r.d()}}}function sl(t){let e,l;return{c(){e=T("div"),l=T("div"),this.h()},l(s){e=G(s,"DIV",{class:!0});var n=D(e);l=G(n,"DIV",{class:!0}),D(l).forEach(h),n.forEach(h),this.h()},h(){p(l,"class","w-[46px] h-[46px] border"),p(e,"class","flex items-center justify-center w-[50px] h-[50px]")},m(s,n){k(s,e,n),y(e,l)},p:F,d(s){s&&h(e)}}}function je(t){let e,l,s=t[26].count+"",n;return{c(){e=T("p"),l=M("x"),n=M(s),this.h()},l(c){e=G(c,"P",{class:!0});var r=D(e);l=V(r,"x"),n=V(r,s),r.forEach(h),this.h()},h(){p(e,"class","absolute right-0 bottom-0 bg-almost-black px-1 text-xs")},m(c,r){k(c,e,r),y(e,l),y(e,n)},p(c,r){r&6&&s!==(s=c[26].count+"")&&W(n,s)},d(c){c&&h(e)}}}function Se(t){let e,l,s,n,c,r,i=t[26].count>1&&De(t);return{c(){e=T("div"),l=T("img"),c=z(),i&&i.c(),r=z(),this.h()},l(o){e=G(o,"DIV",{class:!0});var a=D(e);l=G(a,"IMG",{src:!0,width:!0,height:!0,alt:!0}),c=A(a),i&&i.l(a),r=A(a),a.forEach(h),this.h()},h(){J(l.src,s=t[26].key.includes("trap")?`/images/chara_icons/${t[29]}.webp`:`/images/enemy_icons/${t[29]}.webp`)||p(l,"src",s),p(l,"width","50"),p(l,"height","50"),p(l,"alt",n=t[26].key),p(e,"class","relative")},m(o,a){k(o,e,a),y(e,l),y(e,c),i&&i.m(e,null),y(e,r)},p(o,a){a&6&&!J(l.src,s=o[26].key.includes("trap")?`/images/chara_icons/${o[29]}.webp`:`/images/enemy_icons/${o[29]}.webp`)&&p(l,"src",s),a&6&&n!==(n=o[26].key)&&p(l,"alt",n),o[26].count>1?i?i.p(o,a):(i=De(o),i.c(),i.m(e,r)):i&&(i.d(1),i=null)},d(o){o&&h(e),i&&i.d()}}}function nl(t){let e,l,s;return{c(){e=T("div"),l=T("div"),s=z(),this.h()},l(n){e=G(n,"DIV",{class:!0});var c=D(e);l=G(c,"DIV",{class:!0}),D(l).forEach(h),s=A(c),c.forEach(h),this.h()},h(){p(l,"class","w-[46px] h-[46px] border"),p(e,"class","flex items-center justify-center w-[50px] h-[50px]")},m(n,c){k(n,e,c),y(e,l),y(e,s)},p:F,d(n){n&&h(e)}}}function De(t){let e,l,s=t[26].count+"",n;return{c(){e=T("p"),l=M("x"),n=M(s),this.h()},l(c){e=G(c,"P",{class:!0});var r=D(e);l=V(r,"x"),n=V(r,s),r.forEach(h),this.h()},h(){p(e,"class","absolute right-0 bottom-0 bg-almost-black px-1 text-xs")},m(c,r){k(c,e,r),y(e,l),y(e,n)},p(c,r){r&6&&s!==(s=c[26].count+"")&&W(n,s)},d(c){c&&h(e)}}}function Ne(t){let e;function l(r,i){return r[26].key===""?nl:Se}function s(r,i){return i===Se?xt(r):r}let n=l(t),c=n(s(t,n));return{c(){c.c(),e=L()},l(r){c.l(r),e=L()},m(r,i){c.m(r,i),k(r,e,i)},p(r,i){n===(n=l(r))&&c?c.p(s(r,n),i):(c.d(1),c=n(s(r,n)),c&&(c.c(),c.m(e.parentNode,e)))},d(r){c.d(r),r&&h(e)}}}function Ke(t){let e,l;function s(i,o){return o&6&&(e=null),e==null&&(e=!!Array.isArray(i[20])),e?Te:ll}function n(i,o){return o===Te?tl(i):el(i)}let c=s(t,-1),r=c(n(t,c));return{c(){r.c(),l=L()},l(i){r.l(i),l=L()},m(i,o){r.m(i,o),k(i,l,o)},p(i,o){c===(c=s(i,o))&&r?r.p(n(i,c),o):(r.d(1),r=c(n(i,c)),r&&(r.c(),r.m(l.parentNode,l)))},d(i){r.d(i),i&&h(l)}}}function Oe(t){let e,l,s=t[16]+"",n,c,r,i,o=t[17],a=[];for(let f=0;f<o.length;f+=1)a[f]=Ke(ye(t,o,f));return{c(){e=T("div"),l=T("span"),n=M(s),c=M(":"),r=z(),i=T("div");for(let f=0;f<a.length;f+=1)a[f].c();this.h()},l(f){e=G(f,"DIV",{class:!0});var u=D(e);l=G(u,"SPAN",{class:!0});var _=D(l);n=V(_,s),c=V(_,":"),_.forEach(h),r=A(u),i=G(u,"DIV",{class:!0});var b=D(i);for(let m=0;m<a.length;m+=1)a[m].l(b);b.forEach(h),u.forEach(h),this.h()},h(){p(l,"class","mt-[13px] text-base min-w-[30px] text-center"),p(i,"class","flex flex-wrap gap-x-3"),p(e,"class","flex gap-x-2 px-1.5 pb-1")},m(f,u){k(f,e,u),y(e,l),y(l,n),y(l,c),y(e,r),y(e,i);for(let _=0;_<a.length;_+=1)a[_]&&a[_].m(i,null)},p(f,u){if(u&6&&s!==(s=f[16]+"")&&W(n,s),u&23){o=f[17];let _;for(_=0;_<o.length;_+=1){const b=ye(f,o,_);a[_]?a[_].p(b,u):(a[_]=Ke(b),a[_].c(),a[_].m(i,null))}for(;_<a.length;_+=1)a[_].d(1);a.length=o.length}},d(f){f&&h(e),Y(a,f)}}}function ze(t){let e=Object.keys(t[10][t[15]]).length>0,l,s=e&&Pe(t);return{c(){s&&s.c(),l=L()},l(n){s&&s.l(n),l=L()},m(n,c){s&&s.m(n,c),k(n,l,c)},p(n,c){c&6&&(e=Object.keys(n[10][n[15]]).length>0),e?s?s.p(n,c):(s=Pe(n),s.c(),s.m(l.parentNode,l)):s&&(s.d(1),s=null)},d(n){s&&s.d(n),n&&h(l)}}}function Ae(t){let e=t[10].some(t[6]),l,s=e&&Ie(t);return{c(){s&&s.c(),l=L()},l(n){s&&s.l(n),l=L()},m(n,c){s&&s.m(n,c),k(n,l,c)},p(n,c){c&6&&(e=n[10].some(n[6])),e?s?s.p(n,c):(s=Ie(n),s.c(),s.m(l.parentNode,l)):s&&(s.d(1),s=null)},d(n){s&&s.d(n),n&&h(l)}}}function rl(t){var s;let e,l=((s=t[1])==null?void 0:s.waves)&&Ee(t);return{c(){l&&l.c(),e=L()},l(n){l&&l.l(n),e=L()},m(n,c){l&&l.m(n,c),k(n,e,c)},p(n,[c]){var r;(r=n[1])!=null&&r.waves?l?l.p(n,c):(l=Ee(n),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},i:F,o:F,d(n){l&&l.d(n),n&&h(e)}}}function ol(t,e,l){let{selectedPermGroups:s,mapConfig:n,eliteMode:c,hiddenGroups:r,language:i}=e;function o(_,b,m){const d=structuredClone(s);d[_][b]=m,l(0,s=d)}const a=_=>Object.keys(_).length>0,f=(_,b,m)=>{o(_,b,m)},u=(_,b,m)=>{o(_,b,m)};return t.$$set=_=>{"selectedPermGroups"in _&&l(0,s=_.selectedPermGroups),"mapConfig"in _&&l(1,n=_.mapConfig),"eliteMode"in _&&l(5,c=_.eliteMode),"hiddenGroups"in _&&l(2,r=_.hiddenGroups),"language"in _&&l(3,i=_.language)},t.$$.update=()=>{t.$$.dirty&38&&n&&l(0,s=Xt(n,c,r))},[s,n,r,i,o,c,a,f,u]}class il extends lt{constructor(e){super(),st(this,e,ol,rl,nt,{selectedPermGroups:0,mapConfig:1,eliteMode:5,hiddenGroups:2,language:3})}}function Me(t,e,l){const s=t.slice();return s[35]=e[l],s[37]=l,s}function Ve(t,e,l){const s=t.slice();return s[38]=e[l],s[37]=l,s}function qe(t,e,l){const s=t.slice();return s[40]=e[l],s}function Be(t,e,l){const s=t.slice();return s[40]=e[l],s}function Le(t,e,l){const s=t.slice();s[40]=e[l].key,s[45]=e[l].src,s[46]=e[l].name;const n=s[7].includes(s[40]);return s[47]=n,s}const cl=t=>({}),We=t=>({});function Fe(t,e,l){const s=t.slice();return s[40]=e[l],s}function Re(t){let e,l=K[t[3]].sim_mode+"",s,n,c,r,i=["wave_normal","wave_summons"],o=[];for(let a=0;a<2;a+=1)o[a]=Ue(Fe(t,i,a));return{c(){e=T("p"),s=M(l),c=z(),r=T("div");for(let a=0;a<2;a+=1)o[a].c();this.h()},l(a){e=G(a,"P",{class:!0});var f=D(e);s=V(f,l),f.forEach(h),c=A(a),r=G(a,"DIV",{class:!0});var u=D(r);for(let _=0;_<2;_+=1)o[_].l(u);u.forEach(h),this.h()},h(){p(e,"class",n="title "+t[3]+" svelte-x91ocq"),p(r,"class","grid grid-cols-2")},m(a,f){k(a,e,f),y(e,s),k(a,c,f),k(a,r,f);for(let u=0;u<2;u+=1)o[u]&&o[u].m(r,null)},p(a,f){if(f[0]&8&&l!==(l=K[a[3]].sim_mode+"")&&W(s,l),f[0]&8&&n!==(n="title "+a[3]+" svelte-x91ocq")&&p(e,"class",n),f[0]&131080){i=["wave_normal","wave_summons"];let u;for(u=0;u<2;u+=1){const _=Fe(a,i,u);o[u]?o[u].p(_,f):(o[u]=Ue(_),o[u].c(),o[u].m(r,null))}for(;u<2;u+=1)o[u].d(1)}},d(a){a&&h(e),a&&h(c),a&&h(r),Y(o,a)}}}function Ue(t){let e,l=K[t[3]][t[40]]+"",s,n,c,r,i;function o(){return t[24](t[40])}return{c(){e=T("button"),s=M(l),n=z(),this.h()},l(a){e=G(a,"BUTTON",{class:!0});var f=D(e);s=V(f,l),n=A(f),f.forEach(h),this.h()},h(){p(e,"class",c="flex justify-center items-center border-r border-neutral-700 font-semibold text-lg "+(t[17]===t[40]?"bg-gray-600":"brightness-50 sm:hover:brightness-75 sm:hover:bg-gray-500"))},m(a,f){k(a,e,f),y(e,s),y(e,n),r||(i=Q(e,"click",o),r=!0)},p(a,f){t=a,f[0]&8&&l!==(l=K[t[3]][t[40]]+"")&&W(s,l),f[0]&131072&&c!==(c="flex justify-center items-center border-r border-neutral-700 font-semibold text-lg "+(t[17]===t[40]?"bg-gray-600":"brightness-50 sm:hover:brightness-75 sm:hover:bg-gray-500"))&&p(e,"class",c)},d(a){a&&h(e),r=!1,i()}}}function Ce(t){var q;let e,l,s,n=K[t[3]].permutation_mode+"",c,r,i,o,a,f,u,_,b,m=t[0].elite_mods&&He(t),d=((q=t[20])==null?void 0:q.length)>0&&Ye(t),w=["predefined","user-select"],v=[];for(let g=0;g<2;g+=1)v[g]=Xe(Be(t,w,g));const P=[fl,al],S=[];function B(g,O){return g[16]==="predefined"?0:1}return f=B(t),u=S[f]=P[f](t),{c(){m&&m.c(),e=z(),d&&d.c(),l=z(),s=T("p"),c=M(n),i=z(),o=T("div");for(let g=0;g<2;g+=1)v[g].c();a=z(),u.c(),_=L(),this.h()},l(g){m&&m.l(g),e=A(g),d&&d.l(g),l=A(g),s=G(g,"P",{class:!0});var O=D(s);c=V(O,n),O.forEach(h),i=A(g),o=G(g,"DIV",{class:!0});var N=D(o);for(let E=0;E<2;E+=1)v[E].l(N);N.forEach(h),a=A(g),u.l(g),_=L(),this.h()},h(){p(s,"class",r="title "+t[3]+" svelte-x91ocq"),p(o,"class","grid grid-cols-2")},m(g,O){m&&m.m(g,O),k(g,e,O),d&&d.m(g,O),k(g,l,O),k(g,s,O),y(s,c),k(g,i,O),k(g,o,O);for(let N=0;N<2;N+=1)v[N]&&v[N].m(o,null);k(g,a,O),S[f].m(g,O),k(g,_,O),b=!0},p(g,O){var E;if(g[0].elite_mods?m?(m.p(g,O),O[0]&1&&R(m,1)):(m=He(g),m.c(),R(m,1),m.m(e.parentNode,e)):m&&(Z(),U(m,1,1,()=>{m=null}),$()),((E=g[20])==null?void 0:E.length)>0?d?d.p(g,O):(d=Ye(g),d.c(),d.m(l.parentNode,l)):d&&(d.d(1),d=null),(!b||O[0]&8)&&n!==(n=K[g[3]].permutation_mode+"")&&W(c,n),(!b||O[0]&8&&r!==(r="title "+g[3]+" svelte-x91ocq"))&&p(s,"class",r),O[0]&65544){w=["predefined","user-select"];let j;for(j=0;j<2;j+=1){const C=Be(g,w,j);v[j]?v[j].p(C,O):(v[j]=Xe(C),v[j].c(),v[j].m(o,null))}for(;j<2;j+=1)v[j].d(1)}let N=f;f=B(g),f===N?S[f].p(g,O):(Z(),U(S[N],1,1,()=>{S[N]=null}),$(),u=S[f],u?u.p(g,O):(u=S[f]=P[f](g),u.c()),R(u,1),u.m(_.parentNode,_))},i(g){b||(R(m),R(u),b=!0)},o(g){U(m),U(u),b=!1},d(g){m&&m.d(g),g&&h(e),d&&d.d(g),g&&h(l),g&&h(s),g&&h(i),g&&h(o),Y(v,g),g&&h(a),S[f].d(g),g&&h(_)}}}function He(t){let e,l=K[t[3]].operation_type+"",s,n,c,r;const i=t[23].eliteMods,o=Tt(i,t,t[32],We);return{c(){e=T("p"),s=M(l),c=z(),o&&o.c(),this.h()},l(a){e=G(a,"P",{class:!0});var f=D(e);s=V(f,l),f.forEach(h),c=A(a),o&&o.l(a),this.h()},h(){p(e,"class",n="title "+t[3]+" svelte-x91ocq")},m(a,f){k(a,e,f),y(e,s),k(a,c,f),o&&o.m(a,f),r=!0},p(a,f){(!r||f[0]&8)&&l!==(l=K[a[3]].operation_type+"")&&W(s,l),(!r||f[0]&8&&n!==(n="title "+a[3]+" svelte-x91ocq"))&&p(e,"class",n),o&&o.p&&(!r||f[1]&2)&&Gt(o,i,a,a[32],r?St(i,a[32],f,cl):jt(a[32]),We)},i(a){r||(R(o,a),r=!0)},o(a){U(o,a),r=!1},d(a){a&&h(e),a&&h(c),o&&o.d(a)}}}function Ye(t){let e,l=K[t[3]].hidden_options+"",s,n,c,r,i=t[20],o=[];for(let a=0;a<i.length;a+=1)o[a]=Qe(Le(t,i,a));return{c(){e=T("p"),s=M(l),c=z(),r=T("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=G(a,"P",{class:!0});var f=D(e);s=V(f,l),f.forEach(h),c=A(a),r=G(a,"DIV",{class:!0});var u=D(r);for(let _=0;_<o.length;_+=1)o[_].l(u);u.forEach(h),this.h()},h(){p(e,"class",n="title "+t[3]+" svelte-x91ocq"),p(r,"class","grid grid-cols-3 md:grid-cols-5")},m(a,f){k(a,e,f),y(e,s),k(a,c,f),k(a,r,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(r,null)},p(a,f){if(f[0]&8&&l!==(l=K[a[3]].hidden_options+"")&&W(s,l),f[0]&8&&n!==(n="title "+a[3]+" svelte-x91ocq")&&p(e,"class",n),f[0]&1048804){i=a[20];let u;for(u=0;u<i.length;u+=1){const _=Le(a,i,u);o[u]?o[u].p(_,f):(o[u]=Qe(_),o[u].c(),o[u].m(r,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(a){a&&h(e),a&&h(c),a&&h(r),Y(o,a)}}}function Je(t){let e,l,s,n;return{c(){e=T("div"),l=T("img"),this.h()},l(c){e=G(c,"DIV",{class:!0});var r=D(e);l=G(r,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),r.forEach(h),this.h()},h(){J(l.src,s=t[45])||p(l,"src",s),p(l,"width","56"),p(l,"height","56"),p(l,"alt",n=t[46]),p(l,"class",""),p(e,"class","flex items-center justify-center h-[56px]")},m(c,r){k(c,e,r),y(e,l)},p(c,r){r[0]&1048576&&!J(l.src,s=c[45])&&p(l,"src",s),r[0]&1048576&&n!==(n=c[46])&&p(l,"alt",n)},d(c){c&&h(e)}}}function Qe(t){let e,l,s,n=t[46]+"",c,r,i,o,a,f=t[45]&&Je(t);function u(){return t[25](t[40])}return{c(){e=T("button"),f&&f.c(),l=z(),s=T("span"),c=M(n),r=z(),this.h()},l(_){e=G(_,"BUTTON",{class:!0});var b=D(e);f&&f.l(b),l=A(b),s=G(b,"SPAN",{class:!0});var m=D(s);c=V(m,n),m.forEach(h),r=A(b),b.forEach(h),this.h()},h(){p(s,"class","mt-1 text-xs md:text-sm"),p(e,"class",i="flex flex-col items-center justify-center border border-neutral-700 p-1 "+(t[47]?"bg-gray-600":"brightness-50 sm:hover:brightness-75 sm:hover:bg-gray-500"))},m(_,b){k(_,e,b),f&&f.m(e,null),y(e,l),y(e,s),y(s,c),y(e,r),o||(a=Q(e,"click",u),o=!0)},p(_,b){t=_,t[45]?f?f.p(t,b):(f=Je(t),f.c(),f.m(e,l)):f&&(f.d(1),f=null),b[0]&1048576&&n!==(n=t[46]+"")&&W(c,n),b[0]&1048704&&i!==(i="flex flex-col items-center justify-center border border-neutral-700 p-1 "+(t[47]?"bg-gray-600":"brightness-50 sm:hover:brightness-75 sm:hover:bg-gray-500"))&&p(e,"class",i)},d(_){_&&h(e),f&&f.d(),o=!1,a()}}}function Xe(t){let e,l=K[t[3]][t[40]]+"",s,n,c,r,i;function o(){return t[26](t[40])}return{c(){e=T("button"),s=M(l),n=z(),this.h()},l(a){e=G(a,"BUTTON",{class:!0});var f=D(e);s=V(f,l),n=A(f),f.forEach(h),this.h()},h(){p(e,"class",c="flex justify-center items-center border-r border-neutral-700 font-semibold text-lg "+(t[16]===t[40]?"bg-gray-600":"brightness-50 sm:hover:brightness-75 sm:hover:bg-gray-500"))},m(a,f){k(a,e,f),y(e,s),y(e,n),r||(i=Q(e,"click",o),r=!0)},p(a,f){t=a,f[0]&8&&l!==(l=K[t[3]][t[40]]+"")&&W(s,l),f[0]&65536&&c!==(c="flex justify-center items-center border-r border-neutral-700 font-semibold text-lg "+(t[16]===t[40]?"bg-gray-600":"brightness-50 sm:hover:brightness-75 sm:hover:bg-gray-500"))&&p(e,"class",c)},d(a){a&&h(e),r=!1,i()}}}function al(t){let e,l,s;function n(r){t[30](r)}let c={eliteMode:t[4],mapConfig:t[0],hiddenGroups:t[12],language:t[3]};return t[13]!==void 0&&(c.selectedPermGroups=t[13]),e=new il({props:c}),rt.push(()=>ot(e,"selectedPermGroups",n)),{c(){ee(e.$$.fragment)},l(r){te(e.$$.fragment,r)},m(r,i){le(e,r,i),s=!0},p(r,i){const o={};i[0]&16&&(o.eliteMode=r[4]),i[0]&1&&(o.mapConfig=r[0]),i[0]&4096&&(o.hiddenGroups=r[12]),i[0]&8&&(o.language=r[3]),!l&&i[0]&8192&&(l=!0,o.selectedPermGroups=r[13],it(()=>l=!1)),e.$set(o)},i(r){s||(R(e.$$.fragment,r),s=!0)},o(r){U(e.$$.fragment,r),s=!1},d(r){se(e,r)}}}function fl(t){let e,l,s,n;const c=[_l,ul],r=[];function i(o,a){return o[19]>32||o[11].length<=0?0:1}return e=i(t),l=r[e]=c[e](t),{c(){l.c(),s=L()},l(o){l.l(o),s=L()},m(o,a){r[e].m(o,a),k(o,s,a),n=!0},p(o,a){let f=e;e=i(o),e===f?r[e].p(o,a):(Z(),U(r[f],1,1,()=>{r[f]=null}),$(),l=r[e],l?l.p(o,a):(l=r[e]=c[e](o),l.c()),R(l,1),l.m(s.parentNode,s))},i(o){n||(R(l),n=!0)},o(o){U(l),n=!1},d(o){r[e].d(o),o&&h(s)}}}function ul(t){var b;let e,l,s=K[t[3]].enemy_count+"",n,c,r,i,o,a,f,u=((b=t[0].bonus)==null?void 0:b.type)&&Ze(t);i=new ct({props:{className:"grid grid-flow-col auto-cols-[minmax(100px,1fr)]",$$slots:{default:[dl]},$$scope:{ctx:t}}});let _=t[18].length>0&&et(t);return{c(){u&&u.c(),e=z(),l=T("p"),n=M(s),r=z(),ee(i.$$.fragment),o=z(),_&&_.c(),a=L(),this.h()},l(m){u&&u.l(m),e=A(m),l=G(m,"P",{class:!0});var d=D(l);n=V(d,s),d.forEach(h),r=A(m),te(i.$$.fragment,m),o=A(m),_&&_.l(m),a=L(),this.h()},h(){p(l,"class",c="title "+t[3]+" svelte-x91ocq")},m(m,d){u&&u.m(m,d),k(m,e,d),k(m,l,d),y(l,n),k(m,r,d),le(i,m,d),k(m,o,d),_&&_.m(m,d),k(m,a,d),f=!0},p(m,d){var v;(v=m[0].bonus)!=null&&v.type?u?u.p(m,d):(u=Ze(m),u.c(),u.m(e.parentNode,e)):u&&(u.d(1),u=null),(!f||d[0]&8)&&s!==(s=K[m[3]].enemy_count+"")&&W(n,s),(!f||d[0]&8&&c!==(c="title "+m[3]+" svelte-x91ocq"))&&p(l,"class",c);const w={};d[0]&768|d[1]&2&&(w.$$scope={dirty:d,ctx:m}),i.$set(w),m[18].length>0?_?(_.p(m,d),d[0]&262144&&R(_,1)):(_=et(m),_.c(),R(_,1),_.m(a.parentNode,a)):_&&(Z(),U(_,1,1,()=>{_=null}),$())},i(m){f||(R(i.$$.fragment,m),R(_),f=!0)},o(m){U(i.$$.fragment,m),U(_),f=!1},d(m){u&&u.d(m),m&&h(e),m&&h(l),m&&h(r),se(i,m),m&&h(o),_&&_.d(m),m&&h(a)}}}function _l(t){let e,l,s,n,c=K[t[3]].max_perm_msg.replace("{perm}",`(${t[19]})`)+"",r;return{c(){e=T("p"),s=z(),n=T("div"),r=M(c),this.h()},l(i){e=G(i,"P",{class:!0}),D(e).forEach(h),s=A(i),n=G(i,"DIV",{class:!0});var o=D(n);r=V(o,c),o.forEach(h),this.h()},h(){p(e,"class",l="title "+t[3]+" svelte-x91ocq"),p(n,"class","flex justify-center items-center")},m(i,o){k(i,e,o),k(i,s,o),k(i,n,o),y(n,r)},p(i,o){o[0]&8&&l!==(l="title "+i[3]+" svelte-x91ocq")&&p(e,"class",l),o[0]&524296&&c!==(c=K[i[3]].max_perm_msg.replace("{perm}",`(${i[19]})`)+"")&&W(r,c)},i:F,o:F,d(i){i&&h(e),i&&h(s),i&&h(n)}}}function Ze(t){let e,l,s,n,c,r,i=be(t[2]),o=[];for(let a=0;a<i.length;a+=1)o[a]=$e(qe(t,i,a));return{c(){e=T("p"),l=T("img"),c=z(),r=T("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=G(a,"P",{class:!0});var f=D(e);l=G(f,"IMG",{src:!0,width:!0,alt:!0}),f.forEach(h),c=A(a),r=G(a,"DIV",{class:!0});var u=D(r);for(let _=0;_<o.length;_+=1)o[_].l(u);u.forEach(h),this.h()},h(){J(l.src,s=Vt)||p(l,"src",s),p(l,"width","60"),p(l,"alt","BONUS"),p(e,"class",n="title "+t[3]+" svelte-x91ocq"),p(r,"class","grid grid-flow-col auto-cols-fr")},m(a,f){k(a,e,f),y(e,l),k(a,c,f),k(a,r,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(r,null)},p(a,f){if(f[0]&8&&n!==(n="title "+a[3]+" svelte-x91ocq")&&p(e,"class",n),f[0]&1028){i=be(a[2]);let u;for(u=0;u<i.length;u+=1){const _=qe(a,i,u);o[u]?o[u].p(_,f):(o[u]=$e(_),o[u].c(),o[u].m(r,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(a){a&&h(e),a&&h(c),a&&h(r),Y(o,a)}}}function ml(t){let e,l;return{c(){e=T("img"),this.h()},l(s){e=G(s,"IMG",{src:!0,width:!0,alt:!0}),this.h()},h(){J(e.src,l="/images/enemy_icons/"+t[40]+".webp")||p(e,"src",l),p(e,"width","55"),p(e,"alt","")},m(s,n){k(s,e,n)},p(s,n){n[0]&4&&!J(e.src,l="/images/enemy_icons/"+s[40]+".webp")&&p(e,"src",l)},d(s){s&&h(e)}}}function hl(t){let e,l;return{c(){e=T("div"),l=T("div"),this.h()},l(s){e=G(s,"DIV",{class:!0});var n=D(e);l=G(n,"DIV",{class:!0}),D(l).forEach(h),n.forEach(h),this.h()},h(){p(l,"class","w-[46px] h-[46px] border"),p(e,"class","flex items-center justify-center w-[50px] h-[50px]")},m(s,n){k(s,e,n),y(e,l)},p:F,d(s){s&&h(e)}}}function $e(t){let e,l,s,n,c;function r(f,u){return f[40]===""?hl:ml}let i=r(t),o=i(t);function a(){return t[27](t[40])}return{c(){e=T("button"),o.c(),l=z(),this.h()},l(f){e=G(f,"BUTTON",{class:!0});var u=D(e);o.l(u),l=A(u),u.forEach(h),this.h()},h(){p(e,"class",s="flex justify-center items-center border-r border-neutral-700 font-semibold text-xl "+(t[10]===t[40]?"bg-slate-700":"brightness-50 sm:hover:brightness-75 sm:hover:bg-gray-500"))},m(f,u){k(f,e,u),o.m(e,null),y(e,l),n||(c=Q(e,"click",a),n=!0)},p(f,u){t=f,i===(i=r(t))&&o?o.p(t,u):(o.d(1),o=i(t),o&&(o.c(),o.m(e,l))),u[0]&1028&&s!==(s="flex justify-center items-center border-r border-neutral-700 font-semibold text-xl "+(t[10]===t[40]?"bg-slate-700":"brightness-50 sm:hover:brightness-75 sm:hover:bg-gray-500"))&&p(e,"class",s)},d(f){f&&h(e),o.d(),n=!1,c()}}}function xe(t){let e,l=t[38]+"",s,n,c,r,i;function o(){return t[28](t[37])}return{c(){e=T("button"),s=M(l),n=z(),this.h()},l(a){e=G(a,"BUTTON",{class:!0});var f=D(e);s=V(f,l),n=A(f),f.forEach(h),this.h()},h(){p(e,"class",c="flex justify-center items-center border-r border-neutral-700 font-semibold text-xl "+(t[9]===t[37]?"bg-gray-600":"brightness-50 sm:hover:brightness-75 sm:hover:bg-gray-500"))},m(a,f){k(a,e,f),y(e,s),y(e,n),r||(i=Q(e,"click",o),r=!0)},p(a,f){t=a,f[0]&256&&l!==(l=t[38]+"")&&W(s,l),f[0]&512&&c!==(c="flex justify-center items-center border-r border-neutral-700 font-semibold text-xl "+(t[9]===t[37]?"bg-gray-600":"brightness-50 sm:hover:brightness-75 sm:hover:bg-gray-500"))&&p(e,"class",c)},d(a){a&&h(e),r=!1,i()}}}function dl(t){let e,l=t[8],s=[];for(let n=0;n<l.length;n+=1)s[n]=xe(Ve(t,l,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=L()},l(n){for(let c=0;c<s.length;c+=1)s[c].l(n);e=L()},m(n,c){for(let r=0;r<s.length;r+=1)s[r]&&s[r].m(n,c);k(n,e,c)},p(n,c){if(c[0]&768){l=n[8];let r;for(r=0;r<l.length;r+=1){const i=Ve(n,l,r);s[r]?s[r].p(i,c):(s[r]=xe(i),s[r].c(),s[r].m(e.parentNode,e))}for(;r<s.length;r+=1)s[r].d(1);s.length=l.length}},d(n){Y(s,n),n&&h(e)}}}function et(t){let e,l=K[t[3]].table_headers.enemy+"",s,n=K[t[3]].spacing+"",c,r=K[t[3]].permutation+"",i,o,a,f,u,_,b=K[t[3]].trap+"",m,d=K[t[3]].spacing+"",w,v=K[t[3]].permutation+"",P,S,B,q,g=K[t[3]].random+"",O,N;return f=new ct({props:{className:"grid grid-flow-col auto-cols-[minmax(120px,1fr)]",$$slots:{default:[pl]},$$scope:{ctx:t}}}),{c(){e=T("p"),s=M(l),c=M(n),i=M(r),a=z(),ee(f.$$.fragment),u=z(),_=T("p"),m=M(b),w=M(d),P=M(v),B=z(),q=T("div"),O=M(g),this.h()},l(E){e=G(E,"P",{class:!0});var j=D(e);s=V(j,l),c=V(j,n),i=V(j,r),j.forEach(h),a=A(E),te(f.$$.fragment,E),u=A(E),_=G(E,"P",{class:!0});var C=D(_);m=V(C,b),w=V(C,d),P=V(C,v),C.forEach(h),B=A(E),q=G(E,"DIV",{class:!0});var X=D(q);O=V(X,g),X.forEach(h),this.h()},h(){p(e,"class",o="title "+t[3]+" svelte-x91ocq"),p(_,"class",S="title "+t[3]+" svelte-x91ocq"),p(q,"class","flex justify-center items-center font-semibold")},m(E,j){k(E,e,j),y(e,s),y(e,c),y(e,i),k(E,a,j),le(f,E,j),k(E,u,j),k(E,_,j),y(_,m),y(_,w),y(_,P),k(E,B,j),k(E,q,j),y(q,O),N=!0},p(E,j){(!N||j[0]&8)&&l!==(l=K[E[3]].table_headers.enemy+"")&&W(s,l),(!N||j[0]&8)&&n!==(n=K[E[3]].spacing+"")&&W(c,n),(!N||j[0]&8)&&r!==(r=K[E[3]].permutation+"")&&W(i,r),(!N||j[0]&8&&o!==(o="title "+E[3]+" svelte-x91ocq"))&&p(e,"class",o);const C={};j[0]&278528|j[1]&2&&(C.$$scope={dirty:j,ctx:E}),f.$set(C),(!N||j[0]&8)&&b!==(b=K[E[3]].trap+"")&&W(m,b),(!N||j[0]&8)&&d!==(d=K[E[3]].spacing+"")&&W(w,d),(!N||j[0]&8)&&v!==(v=K[E[3]].permutation+"")&&W(P,v),(!N||j[0]&8&&S!==(S="title "+E[3]+" svelte-x91ocq"))&&p(_,"class",S),(!N||j[0]&8)&&g!==(g=K[E[3]].random+"")&&W(O,g)},i(E){N||(R(f.$$.fragment,E),N=!0)},o(E){U(f.$$.fragment,E),N=!1},d(E){E&&h(e),E&&h(a),se(f,E),E&&h(u),E&&h(_),E&&h(B),E&&h(q)}}}function tt(t){let e,l=t[37]+1+"",s,n,c,r,i;function o(){return t[29](t[37])}return{c(){e=T("button"),s=M(l),n=z(),this.h()},l(a){e=G(a,"BUTTON",{class:!0});var f=D(e);s=V(f,l),n=A(f),f.forEach(h),this.h()},h(){p(e,"class",c="flex justify-center items-center border-r border-neutral-700 font-semibold text-xl "+(t[14]===t[37]?"bg-neutral-600":"brightness-50 sm:hover:brightness-75 sm:hover:bg-gray-500"))},m(a,f){k(a,e,f),y(e,s),y(e,n),r||(i=Q(e,"click",o),r=!0)},p(a,f){t=a,f[0]&16384&&c!==(c="flex justify-center items-center border-r border-neutral-700 font-semibold text-xl "+(t[14]===t[37]?"bg-neutral-600":"brightness-50 sm:hover:brightness-75 sm:hover:bg-gray-500"))&&p(e,"class",c)},d(a){a&&h(e),r=!1,i()}}}function pl(t){let e,l=t[18],s=[];for(let n=0;n<l.length;n+=1)s[n]=tt(Me(t,l,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=L()},l(n){for(let c=0;c<s.length;c+=1)s[c].l(n);e=L()},m(n,c){for(let r=0;r<s.length;r+=1)s[r]&&s[r].m(n,c);k(n,e,c)},p(n,c){if(c[0]&278528){l=n[18];let r;for(r=0;r<l.length;r+=1){const i=Me(n,l,r);s[r]?s[r].p(i,c):(s[r]=tt(i),s[r].c(),s[r].m(e.parentNode,e))}for(;r<s.length;r+=1)s[r].d(1);s.length=l.length}},d(n){Y(s,n),n&&h(e)}}}function bl(t){return{c:F,l:F,m:F,p:F,i:F,o:F,d:F}}function gl(t){var r,i;let e,l,s;function n(o){t[31](o)}let c={mapConfig:t[0],enemies:t[1],language:t[3],waveData:pe(t[0],t[16]==="predefined"?t[19]>32?"random":(r=t[18][t[14]])==null?void 0:r.permutation:t[13],t[12],t[4],t[15],t[10]),timeline:de(t[0],t[12],t[16]==="predefined"?t[19]>32?"random":(i=t[18][t[14]])==null?void 0:i.permutation:t[13],t[4],t[15],t[10])};return t[15]!==void 0&&(c.randomSeeds=t[15]),e=new t[34]({props:c}),rt.push(()=>ot(e,"randomSeeds",n)),{c(){ee(e.$$.fragment)},l(o){te(e.$$.fragment,o)},m(o,a){le(e,o,a),s=!0},p(o,a){var u,_;const f={};a[0]&1&&(f.mapConfig=o[0]),a[0]&2&&(f.enemies=o[1]),a[0]&8&&(f.language=o[3]),a[0]&914449&&(f.waveData=pe(o[0],o[16]==="predefined"?o[19]>32?"random":(u=o[18][o[14]])==null?void 0:u.permutation:o[13],o[12],o[4],o[15],o[10])),a[0]&914449&&(f.timeline=de(o[0],o[12],o[16]==="predefined"?o[19]>32?"random":(_=o[18][o[14]])==null?void 0:_.permutation:o[13],o[4],o[15],o[10])),!l&&a[0]&32768&&(l=!0,f.randomSeeds=o[15],it(()=>l=!1)),e.$set(f)},i(o){s||(R(e.$$.fragment,o),s=!0)},o(o){U(e.$$.fragment,o),s=!1},d(o){se(e,o)}}}function vl(t){return{c:F,l:F,m:F,p:F,i:F,o:F,d:F}}function kl(t){let e,l,s,n,c,r=t[0].branches&&Re(t),i=t[17]==="wave_normal"&&Ce(t),o={ctx:t,current:null,token:null,hasCatch:!1,pending:vl,then:gl,catch:bl,value:34,blocks:[,,,]};return It(yt(()=>import("./index.c611c947.js"),["./index.c611c947.js","./index.51467544.js","./lib.110a2bb4.js","./stage_name_lookup_table.8349fe42.js","./translations.d941d3dd.js","./singletons.86966f15.js","./StageHeadMeta.61b9b52d.js","./TextParser.7b9e5f6b.js","./stores.7780a9ff.js","./DraggableContainer.1874c90f.js","./Icon.e4ad1363.js","./favicon.3b88c928.js","./clickOutside.532dca22.js","..\\assets\\favicon.a4f9be35.css","./TogglePanel.47499b18.js","./boss_icon.7ef3456d.js","..\\assets\\StageHeadMeta.a8669110.css","./languageHelpers.fbc65bd2.js","..\\assets\\index.182c2402.css"],import.meta.url).then(wl),o),{c(){e=T("div"),r&&r.c(),l=z(),i&&i.c(),s=z(),n=L(),o.block.c(),this.h()},l(a){e=G(a,"DIV",{class:!0});var f=D(e);r&&r.l(f),l=A(f),i&&i.l(f),f.forEach(h),s=A(a),n=L(),o.block.l(a),this.h()},h(){p(e,"class","grid grid-cols-[75px_1fr] md:grid-cols-[120px_1fr] divide-y divide-neutral-700 border-y border-neutral-700 text-sm md:text-base")},m(a,f){k(a,e,f),r&&r.m(e,null),y(e,l),i&&i.m(e,null),k(a,s,f),k(a,n,f),o.block.m(a,o.anchor=f),o.mount=()=>n.parentNode,o.anchor=n,c=!0},p(a,f){t=a,t[0].branches?r?r.p(t,f):(r=Re(t),r.c(),r.m(e,l)):r&&(r.d(1),r=null),t[17]==="wave_normal"?i?(i.p(t,f),f[0]&131072&&R(i,1)):(i=Ce(t),i.c(),R(i,1),i.m(e,null)):i&&(Z(),U(i,1,1,()=>{i=null}),$()),Pt(o,t,f)},i(a){c||(R(i),R(o.block),c=!0)},o(a){U(i);for(let f=0;f<3;f+=1){const u=o.blocks[f];U(u)}c=!1},d(a){a&&h(e),r&&r.d(),i&&i.d(),a&&h(s),a&&h(n),o.block.d(a),o.token=null,o=null}}}function yl(t){let e,l;return e=new Dt({props:{key:"stageSim",title:K[t[3]].enemy_routes+" v0.3",size:"subheading",isOpen:qt,$$slots:{default:[kl]},$$scope:{ctx:t}}}),{c(){ee(e.$$.fragment)},l(s){te(e.$$.fragment,s)},m(s,n){le(e,s,n),l=!0},p(s,n){const c={};n[0]&8&&(c.title=K[s[3]].enemy_routes+" v0.3"),n[0]&2097151|n[1]&2&&(c.$$scope={dirty:n,ctx:s}),e.$set(c)},i(s){l||(R(e.$$.fragment,s),l=!0)},o(s){U(e.$$.fragment,s),l=!1},d(s){se(e,s)}}}const wl=({default:t})=>t;function El(t,e,l){var ue,_e;let s,n,c,r,i,{$$slots:o={},$$scope:a}=e,{mapConfig:f,enemies:u,rogueTopic:_,language:b,eliteMode:m,otherStores:d,difficulty:w}=e,v=[],P=[],S=[],B={},q=0,g=0,O=Array.from(Array(50)).map(I=>Math.random()),N="predefined",E="wave_normal",j="",C=0;(ue=d==null?void 0:d.relics)==null||ue.subscribe(I=>{l(21,S=I),I!=null&&I.some(H=>H.id==="rogue_5_copper_S_1")?l(7,v=[...v,"copper_r"]):l(7,v=v.filter(H=>H!=="copper_r"))}),(_e=d==null?void 0:d.disaster)==null||_e.subscribe(I=>{var H;((H=I==null?void 0:I[0])==null?void 0:H.iconId)==="rogue_4_disaster_1"?l(7,v=[...v,"calamity"]):l(7,v=v.filter(ae=>ae!=="calamity"))});const X=[];wt(()=>{X.push(re.subscribe("mode",I=>{l(17,E=I)}))}),Et(()=>{re.setValue("mode","wave_normal"),X.forEach(I=>I())});const mt=I=>re.setValue("mode",I),ht=I=>l(7,v=Ft(v,I,_,w,d)),dt=I=>l(16,N=I),pt=I=>l(10,j=I),bt=I=>l(9,q=I),gt=I=>l(14,g=I);function vt(I){B=I,l(13,B)}function kt(I){O=I,l(15,O)}return t.$$set=I=>{"mapConfig"in I&&l(0,f=I.mapConfig),"enemies"in I&&l(1,u=I.enemies),"rogueTopic"in I&&l(2,_=I.rogueTopic),"language"in I&&l(3,b=I.language),"eliteMode"in I&&l(4,m=I.eliteMode),"otherStores"in I&&l(5,d=I.otherStores),"difficulty"in I&&l(6,w=I.difficulty),"$$scope"in I&&l(32,a=I.$$scope)},t.$$.update=()=>{if(t.$$.dirty[0]&69&&_)switch(_){case"rogue_phantom":if(w>=12&&["level_rogue1_b-6","level_rogue1_b-7","level_rogue1_b-8","level_rogue1_b-9"].includes(f.levelId)){l(7,v=["reforge"]);break}default:l(7,v=[])}t.$$.dirty[0]&2097301&&l(12,s=Qt(v,m,f,_,S)),t.$$.dirty[0]&17&&l(22,C=Rt(f,m)),t.$$.dirty[0]&77&&l(20,n=Wt(f,_,w,b)),t.$$.dirty[0]&17&&l(19,c=m?f.ELITE.max_permutations:f.NORMAL.max_permutations),t.$$.dirty[0]&1&&f&&(l(9,q=0),l(14,g=0),l(10,j=""),re.setValue("mode","wave_normal")),t.$$.dirty[0]&4199441&&l(11,r=Ct(f,s,m,j,C)),t.$$.dirty[0]&2048&&l(8,P=r.reduce((I,{count:H})=>(I.includes(H)||I.push(H),I),[])),t.$$.dirty[0]&2816&&l(18,i=r.reduce((I,{count:H,permutation:ae})=>(H===P[q]&&I.push({count:H,permutation:ae}),I),[])),t.$$.dirty[0]&512&&q&&l(14,g=0)},[f,u,_,b,m,d,w,v,P,q,j,r,s,B,g,O,N,E,i,c,n,S,C,o,mt,ht,dt,pt,bt,gt,vt,kt,a]}class Il extends lt{constructor(e){super(),st(this,e,El,yl,nt,{mapConfig:0,enemies:1,rogueTopic:2,language:3,eliteMode:4,otherStores:5,difficulty:6},null,[-1,-1])}}const Vl=Object.freeze(Object.defineProperty({__proto__:null,default:Il},Symbol.toStringTag,{value:"Module"}));export{Vl as E,Al as a,Zt as c,_t as g,Ml as i,zl as s};
